<!doctype html>
    <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>AI Readiness Report</title>
      <style>
        :root{ --brand-blue:#1f66ff; --brand-green:#18a999; --ink:#0a122a; 
--muted:#5b6b7a; --bg:#f6f9fc; --card:#ffffff; --border:#e5ecf4; }
        *{box-sizing:border-box}
        html,body{margin:0;padding:0;font:14px/1.55 Inter,system-ui,-apple-
system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg)}
        h1,h2,h3{margin:0 0 .5rem 0;font-weight:700}
        h1{font-size:28px} h2{font-size:20px;border-bottom:2px solid 
var(--border);padding-bottom:.35rem;margin-top:1.2rem}
        h3{font-size:16px;margin:.8rem 0 .4rem}
        p{margin:.35rem 0} small,em{color:#6b7280}
        ul,ol{margin:.4rem 0 .6rem 1.2rem} a{color:var(--brand-blue);text-
decoration:none;border-bottom:1px solid rgba(31,102,255,.35)}
        .container{padding:22px}
        .header{display:flex;align-items:center;justify-content:space-
between;background:linear-gradient(90deg,var(--brand-blue),var(--brand-
green));color:#fff;border-bottom:4px solid #0b3dd6}
        .header .inner{display:flex;gap:16px;align-items:center;padding:14px 
22px}
        .header img{height:38px}
        .badge{margin-left:auto;opacity:.95}
        .meta{display:flex;gap:18px;flex-wrap:wrap;color:#fff;font-size:12px}
        .card{background:var(--card);border:1px solid var(--border);border-
radius:14px;padding:16px}
        .grid{display:grid;gap:14px}
        /* Force two-column grids to a single column for improved readability */
        .grid.cols-2{grid-template-columns:1fr}
        .footer{margin-top:18px;padding-top:8px;border-top:1px dashed 
var(--border);font-size:12px;color:#6b7280}
        table{width:100%;border-collapse:collapse;margin:.4rem 0}
        th,td{border:1px solid var(--border);padding:8px;text-
align:left;vertical-align:top}
        th{background:var(--brand-blue);color:#fff}
        .svgbox{background:var(--card);border:1px solid var(--border);border-
radius:14px;padding:10px;display:none}
        .caption{font-size:12px;color:#6b7280;margin-top:.25rem}
        .toc-card{background:var(--card);border:1px dashed var(--border);border-
radius:14px;padding:14px}
        .vision-card{background:linear-gradient(180deg, rgba(24,169,153,.08), 
rgba(31,102,255,.08));border:1px solid rgba(31,102,255,.25);border-left:4px 
solid var(--brand-blue);border-radius:12px;padding:14px;}
        .timeline{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
        .t-card{background:var(--card);border:1px solid var(--border);border-
radius:12px;padding:12px}
        .t-title{font-weight:700;margin-bottom:.2rem}
        /* KPI Tiles */
        .kpi-grid{display:grid;grid-template-columns:repeat(auto-
fit,minmax(110px,1fr));gap:12px;margin-top:.6rem}
        .kpi-item{background:var(--card);border:1px solid var(--border);border-
radius:12px;padding:10px;text-align:center}
        .kpi-item .kpi-label{font-size:12px;color:#6b7280;margin-bottom:2px}
        .kpi-item .kpi-value{font-size:20px;font-weight:700}
        /* Benchmark bars */
        .benchmark-bars{margin-top:.6rem}
        .benchmark-row{display:flex;align-items:center;margin-bottom:6px;font-
size:12px}
        .benchmark-label{width:90px;color:#6b7280;font-weight:500}
        .benchmark-bar{flex:1;height:8px;background:#e5ecf4;border-
radius:4px;position:relative}
        .benchmark-bar span.you{display:block;height:8px;background:var(--brand-
blue);border-radius:4px}
        .benchmark-bar span.avg{position:absolute;top:-
3px;width:2px;height:14px;background:var(--brand-green)}
        /* Risk heatmap */
        .risk-table{width:100%;border-collapse:collapse;margin-top:.6rem;font-
size:12px}
        .risk-table th,.risk-table td{border:1px solid 
var(--border);padding:6px;text-align:center}
        .risk-table th{background:var(--brand-blue);color:#fff}
        .risk-low{background:#e5f3ff}
        .risk-mid{background:#fff7e6}
        .risk-high{background:#ffe5e5}
        /* Funding badges */
        .funding-badges{margin-top:.5rem;display:flex;flex-wrap:wrap;gap:6px}
        .funding-badge{padding:4px 8px;border-radius:8px;background:var(--brand-
blue);color:#fff;font-size:10px;white-space:nowrap}
    thead { display: table-header-group; }
    tr { page-break-inside: avoid; }
    a { word-break: break-word; }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="inner">
          {% if logo_main %}<img src="{{ logo_main }}" alt="KI-Sicherheit" />{% 
endif %}
          <div>
            <h1>AI Readiness Report 2025</h1>
            <div class="meta"><div>Date: {{ today }}</div><div>Language: 
EN</div></div>
          </div>
          <div class="badge">{% if badge_ready %}<img src="{{ badge_ready }}" 
alt="Badge" style="height:38px">{% endif %}</div>
        </div>
      </div>

      <div class="container">
        <!-- Cover: Gauge -->
        <div class="card">
          <h2>Your AI-readiness at a glance</h2>

          {% if preface %}<div style="margin-top:.6rem">{{ preface|safe 
}}</div>{% endif %}
          {% if kpis and kpis|length > 0 %}
            <div class="kpi-grid">
              {% for item in kpis %}
                <div class="kpi-item"><div class="kpi-label">{{ item.label 
}}</div><div class="kpi-value">{{ item.value }}</div></div>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        {% if toc_html and toc_html|trim %}
          <div class="card toc-card">
            <h2>Table of contents</h2>
            {{ toc_html|safe }}
          </div>
        {% endif %}

        <div class="grid cols-2 onepager">
          {% if exec_summary_html and exec_summary_html|trim %}
          <div class="card"><h2>Executive summary</h2><div>{{ 
exec_summary_html|safe }}</div></div>
          {% endif %}
          <div class="card">
            <h2>Dimensions</h2>
            <div class="svgbox">
              <svg id="radar" viewBox="0 0 220 220" width="100%" 
height="220"></svg>
              <div class="caption">Digitalisation · Automation · Paperless · AI 
know-how · …</div>
            </div>
            {% if benchmarks and benchmarks.items()|length > 0 %}
            <div class="benchmark-bars">
              {% for key, b in benchmarks.items() %}
                <div class="benchmark-row">
                  <div class="benchmark-label">{{ key }}</div>
                  <div class="benchmark-bar">
                    <span class="you" style="width:{{ b.self }}%"></span>
                    <span class="avg" style="left:{{ b.industry }}%"></span>
                  </div>
                </div>
              {% endfor %}
              <div class="caption" style="font-size:10px;margin-
top:.25rem">Bars: your value (blue), sector benchmark (green)</div>
            </div>
            {% endif %}
          </div>
        </div>

        {% if (quick_wins_html and quick_wins_html|trim) or (risks_html and 
risks_html|trim) %}
        <div class="grid cols-2 section">
          <div class="card"><h2>⚡ Quick wins</h2><div>{{ (quick_wins_html or 
 '')|safe }}</div></div>
          <div class="card"><h2>⚠️ Key risks</h2><div>{{ (risks_html or '')|safe
  }}</div></div>
        </div>
        {% endif %}
        <div class="grid cols-2 section">
          {% if recommendations_html and recommendations_html|trim %}
            <div class="card"><h2>Recommendations (Top 5) </h2><div>{{ 
 recommendations_html|safe }}</div></div>
          {% endif %}
          {% if roadmap_html and roadmap_html|trim %}
            <div class="card"><h2>Roadmap</h2>
              {% if timeline and (timeline.t30 or timeline.t90 or timeline.t365)
  %}
              <div class="swimlane">
                <div><h3>30 days</h3><ul>{% for it in timeline.t30 %}<li>{{ it 
 }}</li>{% endfor %}</ul></div>
                <div><h3>3 months</h3><ul>{% for it in timeline.t90 %}<li>{{ it 
 }}</li>{% endfor %}</ul></div>
                <div><h3>12 months</h3><ul>{% for it in timeline.t365 %}<li>{{ 
 it }}</li>{% endfor %}</ul></div>
              </div>
              {% else %}
              <div>{{ roadmap_html|safe }}</div>
              {% endif %}
            </div>
          {% endif %}
        </div>

        <div class="grid cols-2 section">
          <div class="card">
            <h2>Funding programmes</h2>
            {% if foerderprogramme_table and foerderprogramme_table|length>0 %}
              <table>
                <thead><tr><th>Name</th><th>Target 
group</th><th>Amount</th><th>Link</th></tr></thead>
                <tbody>
                {% for row in foerderprogramme_table %}
                  <tr><td>{{ row.name }}</td><td>{{ row.zielgruppe }}</td><td>{{
  row.foerderhoehe }}</td>
                    <td>{% if row.link %}<a href="{{ row.link }}">Details</a>{% 
 endif %}</td></tr>
                {% endfor %}
                </tbody>
              </table>
              {% if funding_badges and funding_badges|length>0 %}
              <div class="funding-badges">
                {% for b in funding_badges %}
                  <span class="funding-badge">{{ b }}</span>
                {% endfor %}
              </div>
              {% endif %}
            {% elif dynamic_funding_html and dynamic_funding_html|trim %}
              {{ dynamic_funding_html|safe }}
            {% else %}
              <p><em>No matching items in the local dataset.</em></p>
            {% endif %}
          </div>

          <div class="card">
            <h2>AI tools</h2>
            {% if tools_table and tools_table|length>0 %}
              <table>
                <thead><tr><th>Name</th><th>Use 
case</th><th>Cost</th><th>Link</th></tr></thead>
                <tbody>
                {% for t in tools_table %}
                  <tr><td>{{ t.name }}</td><td>{{ t.usecase }}</td><td>{{ t.cost
  }}</td>
                    <td>{% if t.link %}<a href="{{ t.link }}">Details</a>{% 
 endif %}</td></tr>
                {% endfor %}
                </tbody>
              </table>
            {% else %}
              <p><em>Tool list will be populated dynamically.</em></p>
            {% endif %}
          </div>
        </div>

        {% if risk_heatmap and risk_heatmap|length>0 %}
        <div class="card section">
          <h2>Risk heatmap</h2>
          <table class="risk-table">
            <thead>
              <tr><th></th><th>Low</th><th>Medium</th><th>High</th></tr>
            </thead>
            <tbody>
            {% for row in risk_heatmap %}
              <tr>
                <td>{{ row.category }}</td>
                <td class="{% if row.level in ['niedrig','low'] %}risk-low{% 
endif %}"></td>
                <td class="{% if row.level in ['mittel','medium'] %}risk-mid{% 
endif %}"></td>
                <td class="{% if row.level in ['hoch','high'] %}risk-high{% 
endif %}"></td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
        {% endif %}

        {% if vision_html %}
          <div class="card section">
            <h2>Visionary recommendation</h2>
            <div class="vision-card">{{ vision_html|safe }}</div>
          </div>
        {% endif %}

        {% if sections_html %}
          <div class="card section">
            <h2>Additional sections</h2>
            <div>{{ sections_html|safe }}</div>
          </div>
        {% endif %}

        {% if ueber_mich_html and ueber_mich_html|trim %}
          <div class="card section">
            <h2>About me</h2>
            <div>{{ ueber_mich_html|safe }}</div>
            {# QR-Code removed in Gold-Standard #}
          </div>
        {% endif %}

        {% if glossary_html and glossary_html|trim %}
          <div class="card section">
            <h2>Glossary</h2>
            <div>{{ glossary_html|safe }}</div>
          </div>
        {% endif %}

    <div class="footer">
      <div style="display:flex;align-items:center;gap:12px">
        {% if logo_tuev %}<img src="{{ logo_tuev }}" alt="TÜV" 
style="height:18px">{% endif %}
        {% if logo_euai %}<img src="{{ logo_euai }}" alt="EU AI" 
style="height:18px">{% endif %}
        {% if logo_dsgvo %}<img src="{{ logo_dsgvo }}" alt="DSGVO" 
style="height:18px">{% endif %}
        <span>© 2025 KI-Sicherheit.jetzt – DSGVO & EU-AI-Act-Ready – Wolf 
Hohl</span>
      </div>
      <div style="margin-top:4px; font-size:11px; color:#6b7280">
        {{ footer_text|safe }}
      </div>
    </div>
      </div>

      <!-- Charts (offline SVG) -->
      <script>
        (function(){
          const data = ({{ chart_data_json | safe }}) || { score: 0, dimensions:
  { labels: [], values: [] } };

          // Radar (One-pager)
          const rsvg=document.getElementById('radar'), 
L=(data.dimensions&&data.dimensions.labels)||[], 
V=(data.dimensions&&data.dimensions.values)||[], 
R=90,CX=110,CY=110,N=L.length||6;
          const ring=(k)=>`<circle cx="${CX}" cy="${CY}" r="${(R/5)*k}" 
fill="none" stroke="#e5ecf4" stroke-width="1"/>`; let 
grid=Array.from({length:5},(_,i)=>ring(i+1)).join('');
          for(let i=0;i<N;i++){const a=-Math.PI/2+i*(2*Math.PI/N); grid+=`<line 
x1="${CX}" y1="${CY}" x2="${CX+90*Math.cos(a)}" y2="${CY+90*Math.sin(a)}" 
stroke="#e5ecf4" stroke-width="1"/>`;}
          const pts=V.map((v,i)=>{const a=-Math.PI/2+i*(2*Math.PI/N), 
rr=(Math.max(0,Math.min(5,parseFloat(v)||0))/5)*90; return 
`${CX+rr*Math.cos(a)},${CY+rr*Math.sin(a)}`}).join(' ');
          let lbl=''; for(let i=0;i<N;i++){const 
a=-Math.PI/2+i*(2*Math.PI/N),x=CX+(90+12)*Math.cos(a),y=CY+(90+12)*Math.sin(a); 
lbl+=`<text x="${x}" y="${y}" font-size="9" text-anchor="middle" 
fill="#5b6b7a">${L[i]||''}</text>`;}
          rsvg.innerHTML=`${grid}<polygon points="${pts}" 
fill="rgba(31,102,255,0.18)" stroke="#1f66ff" stroke-width="2"/>${lbl}`;
        })();
      </script>
    </body>
    </html>